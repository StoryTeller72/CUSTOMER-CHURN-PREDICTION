# ?? Customer Churn Prediction
Модель предсказания оттока клиентов телеком-оператора.

Этот проект демонстрирует полный ML-пайплайн: от EDA и обработки данных до обучения модели, интерпретации результатов, трекинга экспериментов (MLflow).

---

# ?? Содержание
- [?? Цель проекта](#-цель-проекта)
- [?? Бизнес-ценность](#-бизнес-ценность)
- [?? Описание решения](#-описание-решения)
- [?? Данные](#-данные)
- [?? ML-Пайплайн](#-ml-пайплайн)
- [?? Метрики качества](#-метрики-качества)
- [?? Интерпретация модели (SHAP)](#-интерпретация-модели-shap)
- [?? Выводы для бизнеса](#-бизнес-интерпретация)
- [?? Технологии](#-технологии)
- [?? Автор](#-автор)

---

# ?? Цель проекта
Обучить модель, которая предсказывает, уйдёт ли клиент телеком-оператора в ближайший месяц.  

Решение включает:
- подготовку данных и feature engineering,
- обучение и выбор лучшей ML-модели  (Logistic Regression, RandomForest, LightGBM, XGBoost, CatBoost)
- интерпретацию результатов через SHAP,
- трекинг экспериментов через MLflow


---

# ?? Бизнес ценность

Уход клиентов (churn) — ключевая проблема телеком-операторов.  
Стоимость привлечения нового клиента выше, чем удержание существующего.

Модель оттока позволяет бизнесу:

### ?? 1. Снизить потери выручки  
Предсказываем клиентов, которые могут уйти ? оператор может сделать персональное предложение.

### ?? 2. Увеличить эффективность удержания  
Запуск таргетированных retention-кампаний вместо рассылки всем подряд.

### ?? 3. Оптимизировать маркетинговый бюджет  
Тратить ресурсы только на клиентов высокого риска.

### ?? 4. Улучшить тарифы и сервис  
SHAP показывает причины ухода ? помогает бизнесу улучшать продукт.

### ?? 5. Увеличить LTV (Customer Lifetime Value)  
Удержание клиентов ? рост общей прибыльности.

---

# ?? Данные

Используется датасет:  
**Telco Customer Churn**  
Источник: Kaggle  
7043 клиентов, 20+ признаков.

Более подробное описание признаков можно найти в [файле](data\columsDescription.md)

---

# ?? ML-Пайплайн

### 1?? EDA
- распределения признаков  
- корреляции  
- Mutual Information  
- поиск выбросов  
- анализ групп с высоким риском ухода  

---

### 2?? Предобработка
- заполнение пропусков  
- One-Hot Encoding 
- StandardScaler для числовых  
- удаление шумовых признаков  
- кастомный feature engineering:

---

### 3?? Обучение модели
Модели:
- Logistic Regression (baseline)
- RandomForest
- LightGBM 
- XGBoost
- **CatBoost**(основная)


---

### 4?? Интерпретация лучший модели
С помощью SHAP:
- summary plot  
- feature importance  
- анализ ключевых признаков  

---

# ?? Метрики качества

### Основная метрика: **F1**
Показывает способность модели отличать уходящих клиентов от остающихся.

В задаче churn prediction стоит не просто выявить клиентов с высоким риском ухода — важно делать это и достаточно полно (Recall), и достаточно точно (Precision).Обе ошибки модели стоят бизнесу денег:

?? Ошибка 1: Низкий Recall (модель пропускает уходящих)

Это значит, что реальные уходящие клиенты не выявлены моделью.
Слишком низкий Recall недопустим.

?? Ошибка 2: Низкий Precision (модель слишком часто «подозревает» не тех)

Если модель считает, что клиент уйдёт, но он остаётся: компания делает лишние скидки или запускает ненужные удерживающие предложения, а значит тратит бюджет удержания впустую

Слишком низкий Precision — также дорого.

**F1-мера** — оптимальная метрика для churn prediction, потому что:
- учитывает оба ключевых бизнес-риска одновременно
- не позволяет «обмануть» модель высоким Recall или Precision при низком другом.


### Вспомогательные метрики:
- **Precision:** 
- **Recall:**   
- **ROC-AUC**

### Результаты моделей
| Model       | F1    | AUC   | Precision| Recall|
| ---         |---    |---    | ---      | ---   |
|LR (baseline)| 0.629 | 0.842 | 0.551    |  0.731|
|RandomForest | 0.634 | 0.845 | 0.551    |  0.845|
|     LGBM    | 0.630 | 0.841 | 0.534    |  0.766|
|     XGBM    | 0.588 | 0.845 | 0.654    |  0.535|
|    CatBoost | 0.636 | 0.842 | 0.580    |  0.705|

Лучшая модуль CatBoost, потому что она показала лучший показатель F1 при лучшем балансе между Preccision  и Recall.

---

# ?? Интерпретация модели shap

<div align="center">
   <img src=img\catBoostShap.png>
</div>

Числовые признаки:
- **Tenure**
    Видна закономерность, старые клиенты и дальше остаются. А новые клиенты, часто отказываются от услуг оператора. **Новые клиенты = основная зона риска**
- **MonthlyCharges**
    Высокие цены на тарифы один из важнейщих факторов оттока.

Категориальные признаки:
-  **Senior Citizen**
    Пенсионеры маленькая группа клиентов, но среди них очень высокий отток.

С остальными признаками есть проблема - на них нет отношения порядка, поэтому они не окрашены. Сложно понять их значения. Рассмотрим важнейшие категориальные признаки отдельно.

<div align="center">
   <img src=img\shapContract.png>
</div>

<div align="center">
   <img src=img\shapInternetService.png>
</div>

<div align="center">
   <img src=img\shapPaymentMethod.png>
</div>

<div align="center">
   <img src=img\shapTechSupport.png>
</div>

<div align="center">
   <img src=img\shapSecurity.png>
</div>

Выводы:
- Тарифы с ежемесячной оплатой являются одной из важных причин оттока клиентов.
- InternetService от FabriOptics заметно увеличивает вероятность ухода клиентов. (Возможно отпугивает высокая цена на оптоволокно)
- Автоматические способы оплаты тарифов удерживают клиентов, а оплата по чекам фактор оттока.
- Клиенты которые  пользуются технической поддержкой и услугами связанными с безопасностью более лояльны, а те кто не пользуются склоны к уходу.

---

# ?? Бизнес интерпретация
Клиенты с высоким риском:
- новые
- платят много
- имеют связь от fiber optic
- используют электронные чеки для оплаты
- не имеют долгосрочного контракта
- пожилые

Что делать бизнесу:
- предложить скидку за продление
- дать спецусловия fiber optic пользователям
- стимулировать переход на auto-pay
- предложить пакетные услуги (Security/TechSupport), которые уменьшают churn
- поддержка новых клиентов в первые месяцы
---

# ?? Технологии

- Python 3.10  
- Pandas / NumPy  
- Scikit-learn  
- LightGBM 
- XGBoost
- CatBoost 
- SHAP  
- MLflow  

---
# Автор

Антинов Рустам

Machine Learning Engineer

Специализируюсь на разработке и валидации ML-систем. В работе уделяю внимание надёжности пайплайнов, воспроизводимости экспериментов и строгим инженерным практикам — от подготовки данных до мониторинга моделей.

Контакты:
ТГ: @antinov_rus
Почта: antinov.rus@mail.ru



